<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.1.1/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" /> -->

<script src="https://kit.fontawesome.com/73db2f45cc.js" crossorigin="anonymous"></script>


   <style>


       body { background-color: #121212; color: white; font-family: 'Segoe UI', sans-serif; padding: 20px; }

h2, h3, caption { color: white; margin-bottom: 16px; }

table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }

thead { background-color: #1f1f1f; }

th, td { padding: 8px 12px; border: 1px solid #333; text-align: center; }

th { font-weight: bold; }

.winner-box { background-color: #1e1e1e; padding: 16px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 0 10px rgba(255, 255, 255, 0.1); }

.winner-title { font-size: 1.3em; font-weight: bold; margin-bottom: 10px; }

.winner-line { display: flex; justify-content: space-between; padding: 6px 0; border-top: 1px solid #444; }

.winner-line span:first-child { color: gold; font-weight: bold; text-shadow: 0 0 5px gold; }

.score-display { color: #ccc; font-weight: normal; }

caption { caption-side: top; font-weight: bold; font-size: 1.2em; text-align: left; margin: 10px 0; color: white; }

@media screen and (max-width: 600px) { table, thead, tbody, th, td, tr { display: block; } th, td { text-align: right; padding-left: 50%; position: relative; } th::before, td::before { position: absolute; left: 10px; top: 8px; white-space: nowrap; color: #aaa; } }


        

    
        </style>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <title>klasemen LigaDusun Tanjung Bulan</title>
</head>

<body class="bg-dark text-light">
   <!-- <div class="container-fluid d-flex justify-content-center align-items-center" style="height: 100vh;">
     -->   <div class="col-lg-3 d-flex flex-column align-items-center justify-content-center border-custom py-4">
            <div class="d-block border-light border border-2 rounded-circle overflow-hidden" style="width: 8em;"
                data-bs-toggle="modal" data-bs-target="#showImage" id="profile">
                <img class="img-fluid">
            </div>
            <div class="pt-3 text-center">
                <h5>Tanjung Bulan Squad <span style="color:#00BFFF;"><i class="fa-solid fa-circle-check"></i></span></h5><br/>
                
                
                
            </div>
            
    </div> 

    <!-- Modal -->
    <div class="modal fade" id="showImage" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="showImageLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="showImageLabel">Tanjung Bulan Squad</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img class="img-fluid img-thumbnail profile">
                </div>
            </div>
        </div>
    </div>

    <script>
        // * img position
        const position = '/img/tbsquad.jpg';

        // ! Don't change this line
        $(document).ready(() => {
            $('#profile img').attr('src', position);
        });
    </script>


    

    <script>
        $(document).ready(() => {
            $('#profile').on('click', () => {
                $('img.img-fluid.profile').attr('src',
                    $('#profile img').attr('src')
                );
            })
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>



<h5 id="TopGlobal"><i class="fa-solid fa-ranking-star"></i> LigaDusun Tanjung Bulan</h5>

    
    
    <div id="klasemen"></div>
<div id="info-poin" style="margin-top: 1em;">
  <strong>Keterangan:</strong><br>
  P = Pertandingan Dimainkan<br/>M = Menang<br/>K = Kalah<br/>SS = Skor Set (set menang - set kalah)<br/>Poin = Skor akhir<br>
  *Menang 2:0 = 3 poin<br/>*Menang 2:1 = 2 poin<br/>*Kalah 1:2 = 1 poin<br/>*Kalah 0:2 = 0 poin
</div>

<h3 style="margin-top:2em;">Jadwal Pertandingan</h3>
<ul id="jadwal"></ul>

<h3>Hasil Pertandingan</h3>
<ul id="hasil"></ul>

<h3>Nama Tim & Pemain</h3>
<ul id="tim-pemain"></ul>

<script>
async function fetchJSON(file) {
  const res = await fetch(file);
  return res.json();
}

function createKlasemen(timList, matchList) {
  const klasemen = {};

  timList.forEach(tim => {
    klasemen[tim.id] = {
      nama: tim.nama,
      P: 0,
      M: 0,
      K: 0,
      poin: 0,
      skorSetMenang: 0,
      skorSetKalah: 0,
      SS: ''
    };
  });

  matchList.forEach(match => {
    if (!match.hasil || typeof match.hasil !== 'object') return;

    const { timA, timB, hasil } = match;
    const skorA = hasil.skorA;
    const skorB = hasil.skorB;

    if (typeof skorA !== 'number' || typeof skorB !== 'number') return;

    const tim1 = klasemen[timA];
    const tim2 = klasemen[timB];

    tim1.P += 1;
    tim2.P += 1;

    tim1.skorSetMenang += skorA;
    tim1.skorSetKalah += skorB;
    tim2.skorSetMenang += skorB;
    tim2.skorSetKalah += skorA;

    // Hitung poin berdasarkan aturan BO3
    if (skorA === 2 && skorB === 0) {
      tim1.M += 1;
      tim2.K += 1;
      tim1.poin += 3;
    } else if (skorA === 2 && skorB === 1) {
      tim1.M += 1;
      tim2.K += 1;
      tim1.poin += 2;
      tim2.poin += 1;
    } else if (skorB === 2 && skorA === 0) {
      tim2.M += 1;
      tim1.K += 1;
      tim2.poin += 3;
    } else if (skorB === 2 && skorA === 1) {
      tim2.M += 1;
      tim1.K += 1;
      tim2.poin += 2;
      tim1.poin += 1;
    }

    tim1.SS += `${skorA}-${skorB} `;
    tim2.SS += `${skorB}-${skorA} `;
  });

  const sorted = Object.values(klasemen).sort((a, b) => {
    if (b.poin !== a.poin) return b.poin - a.poin;
    const selisihA = a.skorSetMenang - a.skorSetKalah;
    const selisihB = b.skorSetMenang - b.skorSetKalah;
    return selisihB - selisihA;
  });

  let html = `<table border="1" cellspacing="0" cellpadding="5">
    <tr><th>No</th><th>Tim</th><th>P</th><th>M</th><th>K</th><th>SS</th><th>Poin</th></tr>`;
  sorted.forEach((tim, i) => {
    html += `<tr>
      <td>${i + 1}</td>
      <td>${tim.nama}</td>
      <td>${tim.P}</td>
      <td>${tim.M}</td>
      <td>${tim.K}</td>
      <td>${tim.SS.trim()}</td>
      <td style="color:green;font-weight:bold;">${tim.poin}</td>
    </tr>`;
  });
  html += `</table>`;

  document.getElementById("klasemen").innerHTML = html;
}

function tampilkanJadwal(matchList, timList) {
  const jadwalEl = document.getElementById("jadwal");
  const getTim = id => timList.find(t => t.id === id)?.nama || id;

  matchList.forEach(match => {
    const { timA, timB, waktu } = match;
    const teks = `${getTim(timA)} vs ${getTim(timB)}${waktu ? ' - ' + waktu : ''}`;
    const li = document.createElement("li");
    li.textContent = teks;
    jadwalEl.appendChild(li);
  });
}

function tampilkanHasil(matchList, timList) {
  const hasilEl = document.getElementById("hasil");
  const getTim = id => timList.find(t => t.id === id)?.nama || id;

  matchList.forEach(match => {
    if (!match.hasil) return;
    const { timA, timB, hasil } = match;
    if (typeof hasil.skorA !== 'number' || typeof hasil.skorB !== 'number') return;

    const li = document.createElement("li");
    li.textContent = `${getTim(timA)} ${hasil.skorA} - ${hasil.skorB} ${getTim(timB)}`;
    hasilEl.appendChild(li);
  });
}

function tampilkanTimPemain(timList) {
  const list = document.getElementById("tim-pemain");
  timList.forEach(tim => {
    const li = document.createElement("li");
    li.innerHTML = `<strong>${tim.nama}:</strong> ${tim.pemain.join(", ")}`;
    list.appendChild(li);
  });
}

(async () => {
  const timList = await fetchJSON('tim.json');
  const matchList = await fetchJSON('main.json');

  createKlasemen(timList, matchList);
  tampilkanJadwal(matchList, timList);
  tampilkanHasil(matchList, timList);
  tampilkanTimPemain(timList);
})();
</script>


<br/><br/>
<center>Made in ©️RISMA AL-HUDA</center>
<br></body>

    </html>

    
