<!DOCTYPE html>
<html>
<head>
  <title>Input Tabungan Putra</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="daftarnama.js"></script>
</head>
<body>
  <h2>Input Tabungan Putra</h2>

  <label for="nama">Nama:</label>
  <select id="nama"></select><br><br>

  <label for="tipe">Tipe Transaksi:</label>
  <select id="tipe">
    <option value="tabung">Tabung</option>
    <option value="ambil">Ambil</option>
  </select><br><br>

  <label for="jumlah">Jumlah (Rp):</label>
  <input type="number" id="jumlah"><br><br>

  <button onclick="kirimData()">Simpan</button>

  <script>
    // Konfigurasi Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAfkARu79wTh-XGLZprTfxY4XDQ65F-gE8",
      authDomain: "bank-risma.firebaseapp.com",
      databaseURL: "https://bank-risma-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "bank-risma",
      storageBucket: "bank-risma.firebasestorage.app",
      messagingSenderId: "20349077579",
      appId: "1:20349077579:web:6b81da610dc0715289e5ce"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Auto-tanggal
    const today = new Date();
    const bulan = today.toLocaleString('default', { month: 'long' });
    const tahun = today.getFullYear();
    const namaKoleksi = `${bulan} ${tahun}`; // Contoh: Agustus 2025

    // Isi pilihan nama dari daftar putra
    const namaSelect = document.getElementById('nama');
    daftarnama.putra.forEach(nama => {
      const option = document.createElement('option');
      option.value = nama;
      option.text = nama;
      namaSelect.appendChild(option);
    });

    // Kirim data ke Firestore
    function kirimData() {
      const nama = document.getElementById('nama').value;
      const tipe = document.getElementById('tipe').value;
      const jumlah = parseInt(document.getElementById('jumlah').value);

      if (!nama || isNaN(jumlah) || jumlah <= 0) {
        alert("Pastikan semua data diisi dengan benar.");
        return;
      }

      db.collection(namaKoleksi).add({
        nama,
        tipe,
        jumlah,
        gender: "putra",
        tanggal: firebase.firestore.Timestamp.fromDate(today)
      })
      .then(() => {
        alert("Data berhasil disimpan!");
        document.getElementById('jumlah').value = '';
      })
      .catch((error) => {
        alert("Gagal menyimpan data: " + error);
      });
    }
  </script>
</body>
</html>
